# 패키지별 상세 클래스 다이어그램 (Package-Specific Class Diagrams)

## 1. 도메인 패키지 (Domain Package)

```mermaid
classDiagram
    %% Domain Entities
    class User {
        <<abstract>>
        +Long id
        +String name
        +String email
        +String password
        +String phoneNumber
        +String userType
    }
    class Customer {
        +String address
        +CustomerTier tier
    }
    class Staff {
        <<abstract>>
        +String role
        +canHandle(OrderStatus)* boolean
    }
    class KitchenStaff {
        +canHandle(OrderStatus) boolean
    }
    class DeliveryStaff {
        +canHandle(OrderStatus) boolean
    }
    
    class Order {
        +Long orderId
        +String orderDate
        +String deliveryAddress
        +String dinnerType
        +String servingStyle
        +OrderStatus status
        +BigDecimal totalPrice
        +addOrderItem(OrderItem)
    }
    class OrderStatus {
        <<enumeration>>
        PENDING
        INPROGRESS
        READY
        DELIVERED
        CANCELLED
    }
    class OrderItem {
        +Long id
        +int quantity
        +BigDecimal price
        +MenuItem menuItem
    }
    class OrderProcessLog {
        +Long id
        +OrderStatus status
        +Long staffId
        +LocalDateTime processTime
        +String staffRole
    }
    
    class MenuItem {
        +Long id
        +String name
        +BigDecimal unitPrice
        +boolean isBaseItem
        +String dinnerType
    }
    class Inventory {
        +Long stockID
        +String itemName
        +BigDecimal quantityAvailable
        +String unit
        +BigDecimal minQuantity
        +String status
        +updateStatus()
        +decreaseQuantity(BigDecimal)
        +increaseQuantity(BigDecimal)
    }
    class Recipe {
        +Long id
        +MenuItem menuItem
        +Inventory inventory
        +BigDecimal requiredQuantity
    }

    %% Relationships
    User <|-- Customer
    User <|-- Staff
    Staff <|-- KitchenStaff
    Staff <|-- DeliveryStaff

    Order "1" --> "1" Customer : ordered by
    Order "1" *-- "*" OrderItem : contains
    OrderItem "*" --> "1" MenuItem : represents
    Order "1" *-- "*" OrderProcessLog : audit log

    MenuItem "1" --> "*" Recipe : has recipes
    Recipe "*" --> "1" Inventory : uses ingredient
```

## 2. 서비스 패키지 (Service Package)

```mermaid
classDiagram
    namespace Service {
        class OrderService {
            +createOrder(OrderRequestDto) Long
            +createOrderFromChat(Long, String, int) Long
            +getOrders(Long) List~OrderListResponseDto~
            +getOrderDetails(Long) OrderResponseDto
            +deleteOrder(Long)
        }
        class StaffOrderService {
            +getOrders(OrderStatus) List~OrderResponseDto~
            +updateStatusAndAudit(Long, OrderStatus, Long, String)
        }
        class InventoryService {
            +getAllInventories() List~InventoryResponseDto~
            +getInventory(Long) InventoryResponseDto
            +createInventory(InventoryRequestDto) Long
            +updateQuantity(Long, BigDecimal)
            +increaseQuantity(Long, BigDecimal)
            +updateInventoryInfo(Long, InventoryRequestDto)
            +deleteInventory(Long)
            +deductStock(MenuItem, int)
        }
        class PricingService {
            +calculateBaseOrderPrice(String, String, int) BigDecimal
            +calculateOrderItemPrice(MenuItem, String, int, int) BigDecimal
            +calculateDiscount(BigDecimal, int) DiscountResult
        }
        class AccessControlService {
            +verifyStaffAccess(Staff, OrderStatus)
        }
        class AuthenticationService {
            <<interface>>
            +registerCustomer(Customer) Long
            +authenticateCustomer(String, String) Customer
            +authenticateStaff(String, String) Staff
        }
        class AuthenticationServiceImpl {
            +registerCustomer(Customer) Long
            +authenticateCustomer(String, String) Customer
            +authenticateStaff(String, String) Staff
        }
        class ChatOrchestratorService
    }
    
    %% Relationships
    AuthenticationServiceImpl ..|> AuthenticationService
    
    OrderService ..> InventoryService : uses
    OrderService ..> PricingService : uses
    
    StaffOrderService ..> AccessControlService : uses
```

## 3. 컨트롤러 패키지 (Controller Package)

```mermaid
classDiagram
    namespace Controller {
        class OrderController {
            +confirmOrder(OrderRequestDto) ResponseEntity
            +getOrders(Long) ResponseEntity
            +deleteOrder(Long) ResponseEntity
            +getOrderDetails(Long) ResponseEntity
        }
        class StaffOrderController {
            +getOrdersByStatus(OrderStatus) ResponseEntity
            +updateOrderStatus(Long, Map) ResponseEntity
        }
        class AuthController {
            +register(UserRegisterRequest) ResponseEntity
            +loginUsers(LoginRequest) ResponseEntity
            +loginStaffs(LoginRequest) ResponseEntity
        }
        class InventoryController {
            +getAllInventories() ResponseEntity
            +getInventory(Long) ResponseEntity
            +createInventory(InventoryRequestDto) ResponseEntity
            +updateQuantity(Long, Map) ResponseEntity
            +increaseQuantity(Long, Map) ResponseEntity
            +updateInventory(Long, InventoryRequestDto) ResponseEntity
            +deleteInventory(Long) ResponseEntity
        }
    }
    
    class Service {
        <<Simplified>>
    }
    
    class DTO {
        <<Simplified>>
    }

    OrderController ..> Service : uses
    StaffOrderController ..> Service : uses
    AuthController ..> Service : uses
    InventoryController ..> Service : uses
    
    Controller ..> DTO : uses
```

## 4. DTO 패키지 (DTO Package)

```mermaid
classDiagram
    namespace DTO {
        class OrderRequestDto {
            +Long customerId
            +String dinnerType
            +String servingStyle
            +String deliveryAddress
            +List~OrderItemDto~ items
            +int quantity
        }
        class OrderResponseDto {
            +Long id
            +String dinnerName
            +BigDecimal totalPrice
            +String status
            +String customerName
            +List~ItemDto~ items
            +String driverName
            +Long kitchenStaffId
            +Long deliveryStaffId
        }
        class LoginRequest {
            +String email
            +String password
        }
        class UserRegisterRequest {
            +String name
            +String email
            +String password
            +String address
            +String phoneNumber
        }
        class InventoryRequestDto {
            +String itemName
            +BigDecimal quantityAvailable
            +BigDecimal minQuantity
        }
        class InventoryResponseDto {
            +Long stockID
            +String itemName
            +BigDecimal quantityAvailable
            +String status
            +List~String~ usedMenus
        }
    }
```

## 5. 전체 패키지 다이어그램 (Overall Package Diagram)

```mermaid
classDiagram
    namespace Controller {
        class AuthController
        class ChatController
        class CustomerController
        class InventoryController
        class MenuItemController
        class OrderController
        class StaffOrderController
    }
    
    namespace Service {
        class AuthenticationService
        class AuthenticationServiceImpl
        class ChatOrchestratorService
        class InventoryService
        class OrderService
        class StaffOrderService
        class PricingService
        class AccessControlService
    }
    
    namespace Repository {
        class CustomerRepository
        class InventoryRepository
        class MenuItemRepository
        class OrderProcessLogRepository
        class OrderRepository
        class StaffRepository
    }
    
    namespace Domain {
        class Customer
        class Staff
        class Order
        class Inventory
        class MenuItem
    }
    
    namespace DTO {
        class OrderRequestDto
        class OrderResponseDto
        class InventoryRequestDto
    }

    Controller ..> Service : uses
    Controller ..> DTO : uses
    Service ..> Repository : uses
    Service ..> Domain : uses
    Service ..> DTO : uses
    Repository ..> Domain : manages
```
